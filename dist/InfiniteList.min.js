!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.InfiniteList=t():e.InfiniteList=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){var r=n(2),i=n(3),o=n(5),a=n(6),f=n(7),l=n(4),m=1e3,s=function(e){function t(e,t){return H=e,g(e),M=new f(e,T,E,d),E.useNativeScroller?S=new i(O,function(e){L=e||0,N=!0}):(w=new o(O),S=new r(H,function(e){L=e||0,N=!0},t),S.setDimensions(Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)),s(),c(),this}function n(){a.stopAnimationLoop(),H.removeChild(O)}function s(){a.startAnimationLoop(function(){if(N)p();else{var e=Date.now();e-A>m&&(x=H.clientHeight,A=e,x!=H.clientHeight||y!=H.clientWidth?(L=O.scrollTop,c()):E.useNativeScroller&&L!=O.scrollTop&&(L=O.scrollTop,p()))}})}function u(e){for(var t=e||0;t<E.itemsCount;++t)C[t]=E.itemHeightGetter&&E.itemHeightGetter(t)||C[t]||200;E.hasMore&&(C[E.itemsCount]=200)}function g(e){T=document.createElement("div"),l.applyElementStyle(T,{position:E.useNativeScroller?"relative":"absolute",width:"100%"}),O=document.createElement("div"),l.applyElementStyle(O,{position:"relative",height:"100%",width:"100%",overflowY:E.useNativeScroller?"scroll":"hidden","-webkit-overflow-scrolling":"touch"}),O.appendChild(T),e.appendChild(O)}function c(e){var t=M.getRenderedItems()[0],n=t&&t.getItemIndex()||0,r=t&&t.getItemOffset()||0,i=L-r;e&&(e.itemsCount&&(E.itemsCount>e.itemsCount&&(n=0,O.scrollTop=0,i=0),E.itemsCount=e.itemsCount,C=C.slice(0,e.itemsCount)),null!=e.hasMore&&(E.hasMore=e.hasMore)),x=H.clientHeight,y=H.clientWidth,M.refresh(),u(),w&&w.refresh(),e&&!E.useNativeScroller&&I(n,!1,i),N=!0}function h(){var e=E.itemsCount-1+(E.hasMore?1:0),t=M.getRenderedItems(),n=t[t.length-1],r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;if(t.length>0&&0==t[0].getItemIndex()&&(r=t[0].getItemOffset()),n&&n.getItemIndex()==e&&(i=n.getItemOffset()+n.getItemHeight()-x),E.useNativeScroller){var o=0;C.forEach(function(e){o+=e}),l.applyElementStyle(T,{height:o+"px"})}else S.setDimensions(r,i)}function p(){var e;h(),E.useNativeScroller||l.applyTransformStyle(T,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+-L+", 0, 1)"),N=M.render(L,D,n,C),e=M.getRenderedItems(),D=null,n=null,e.forEach(function(e){C[e.getItemIndex()]=e.getItemHeight()});var t=e[0];if(t){for(var n=t.getItemOffset(),r=0,i=0;i<t.getItemIndex();++i)r+=C[i];if(n!=r){var o=n-r;O.scrollTop-=o,e.forEach(function(e){e.setItemOffset(e.getItemOffset()-o)})}}for(var a=0,f=0,i=0;i<C.length;++i)"number"==typeof C[i]&&(a+=C[i],f++);a/=f,w&&w.render(a*e[0].getItemIndex()+L-e[0].getItemOffset(),a*E.itemsCount)}function d(e){E.pageFetcher(E.itemsCount,function(t,n){E.hasMore=n,E.itemsCount+=t,u(E.itemsCount-t),S.scrollTo(M.getRenderedItems()[M.getRenderedItems().length-1].getItemOffset()-x),E.useNativeScroller,e()})}function I(e,t,n){var r=0;if(E.itemHeightGetter)for(var i=0;i<e;++i)r+=E.itemHeightGetter(i);else D=e;b=n||0,S.scrollTo(r,E.itemHeightGetter&&t)}function v(e){var t=M.getRenderedItems(),n=t.filter(function(t){return t.getItemIndex()==e})[0];if(n){var r=E.itemHeightGetter&&E.itemHeightGetter(e);r||(r=n.getDomElement().clientHeight,C[e]=r),n.setItemHeight(r);var i=n.getItemIndex()-t[0].getItemIndex(),o=t[i+1];if(n.getItemOffset()<L)for(;o&&n;)n.setItemOffset(o.getItemOffset()-n.getItemHeight()),o=n,n=t[--i];else for(;o&&n;)o.setItemOffset(n.getItemOffset()+n.getItemHeight()),n=o,o=t[++i+1]}}var x,y,E={itemHeightGetter:null,recalculateItemHeights:!1,itemRenderer:null,itemTypeGetter:null,pageFetcher:null,loadMoreRenderer:function(e,t){t.innerHTML='<div style="margin-left:14px;height:50px">Loading...</div>'},hasMore:!1,useNativeScroller:!1,itemsCount:0},H=null,O=null,T=null,w=null,M=null,S=null,C=[],L=0,D=0,b=0,N=!0;for(var G in e)e.hasOwnProperty(G)&&(E[G]=e[G]);var R=e.initialPage;R&&(E.itemsCount=R.itemsCount||0,E.hasMore=R.hasMore||!1);var A=0;return{attach:t,detach:n,scrollToItem:I,refresh:c,refreshItemHeight:v}};e.exports=s},function(e,t){var n=525,r=function(e,t){function r(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function i(e){E=e,t(e)}function o(){var e,t,r;if(v)if(e=Date.now()-c,t=v*Math.exp(-e/n),r=H-t,r<h){if(H-t>=h-2)return void i(h);a(!0)}else if(r>p){if(H-t<=p+2)return void i(p);a(!1)}else t>2||t<-2?(i(H-t),requestAnimationFrame(o)):i(H)}function a(e){var t=e?h:p,r=e&&v>0||!e&&v<0;if(0!=v){var o=Date.now()-c,f=v*Math.exp(-o/(H==t?125:n));if(r&&Math.abs(f)<2)return void i(e?h:p);i(H-f),r?H!=t&&(H=t,v=H-E,c=new Date):(H=t-.1*(t-H),v=H-E),requestAnimationFrame(function(){a(e)})}}function f(e){x=!0,y=r(e),I=v=0,d=E,c=Date.now(),m(e),e.stopPropagation()}function l(e){var t,n,o=E<h||E>p?.5:1;x&&(m(e),t=r(e),n=y-t,(n>2||n<-2)&&(y=t,i(E+n*o))),e.preventDefault(),e.stopPropagation()}function m(e){var t=e.touches||[{pageX:e.pageX,pageY:e.pageY}],n=e.timeStamp,r=t[0].pageY;2===t.length&&(r=Math.abs(t[0].pageY+t[1].pageY)/2),O.push({offset:r,timestamp:n}),O.length>60&&O.splice(0,30)}function s(e){x=!1;for(var t=O.length-1,n=t-1,r=t-1;r>0&&O[r].timestamp>O[t].timestamp-100;r-=1)n=r;var i=O[t].timestamp-O[n].timestamp,a=O[t].offset-O[n].offset,f=-1e3*a/(1+i);I=.8*f+.2*I,v=1*I,H=Math.round(E+v),c=Date.now(),requestAnimationFrame(o),e.stopPropagation()}function u(e,t){var n=4e3;t?(e-E>n?E=e-n:E-e>n&&(E=e+n),v=e-E,H=e,c=Date.now(),requestAnimationFrame(o)):(v=0,i(e))}function g(e,t){h=e,p=t}var c=0,h=0,p=0,d=0,I=0,v=0,x=0,y=0,E=0,H=0,O=[];return e.addEventListener("touchstart",f),e.addEventListener("touchmove",l),e.addEventListener("touchend",s),e.addEventListener("mousedown",f),e.addEventListener("mousemove",l),e.addEventListener("mouseup",s),{setDimensions:g,scrollTo:u}};e.exports=r},function(e,t,n){var r=n(4),i=function(e,t){return e.addEventListener("scroll",function(){t(e.scrollTop)}),{setDimensions:function(t,n){r.applyElementStyle(e,{height:n-t+"px"})},scrollTo:function(){t(e.scrollTop)}}};e.exports=i},function(e,t){var n=function(e,t){Object.keys(t).forEach(function(n){e.style[n]!=t[n]&&(e.style[n]=t[n])})},r=function(e,t){var r={};["webkit","Moz","O","ms"].forEach(function(e){r[e+"Transform"]=t}),n(e,r)};e.exports={applyElementStyle:n,applyTransformStyle:r}},function(e,t,n){var r=n(4),i=function(e){function t(t,n){var a=(e.parentElement,Math.max(10,Math.floor(o/n*o))),f=Math.floor(t/(n-o)*(o-a)),l=a+"px";r.applyElementStyle(i,{height:l}),r.applyTransformStyle(i,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+f+", 0, 1)")}function n(){o=e.parentElement.clientHeight}var i=document.createElement("div"),o=e.parentElement.clientHeight;return r.applyElementStyle(i,{position:"absolute",top:"0px",right:"0px",marginRight:"3px",opacity:.3,width:"5px",backgroundColor:"#333"}),e.appendChild(i),{render:t,refresh:n}};e.exports=i},function(e,t){function n(e){var t=(new Date).getTime(),n=0;a=!0;var r=function(){var i=(new Date).getTime();n++,i-t>200&&(o=Math.min(60,1e3*n/(i-t)),t=i,n=0),e(),a&&requestAnimationFrame(r)};requestAnimationFrame(r)}function r(){a=!1}function i(){return o}var o=60,a=!1;e.exports={startAnimationLoop:n,stopAnimationLoop:r,getFPS:i}},function(e,t,n){var r=n(8),i=n(9),o=(n(6),30),a=1e3/o,f=function(e,t,n,o){function f(e,t,r,i){var o=(new Date).getTime(),u=2;if("number"==typeof t&&t>=0){for(t=Math.max(0,Math.min(t,n.itemsCount-1));I.length>0;)x.addLayer(I.pop());var g=s(t);g.setItemOffset(e-(r||0)),I.push(g)}for(;I.length>1&&I[0]&&I[0].getItemOffset()+I[0].getItemHeight()<e;)x.addLayer(I.shift());if(1==I.length&&I[0].getItemOffset()<e){for(var c=I[0].getItemOffset()+I[0].getItemHeight(),h=I[0].getItemIndex();c<e;)++h,c+=i[h];if(I[0].getItemIndex()!=h)return f(c-i[h],h,0,i)}else if(I[0].getItemOffset()>e+p){for(var h=0,d=i[0];d<e;)h++,d+=i[h];return f(d-i[h],h,0,i)}for(var v=I[0];v&&v.getItemIndex()>0&&v.getItemOffset()>e;)if(v=l(v),I[I.length-1].getItemOffset()>e+p&&x.addLayer(I.pop()),(new Date).getTime()-o>a)return!0;var y=I[I.length-1];if(y.getItemIndex()<n.itemsCount&&"$LoadMore"==y.getIdentifier()){if(y=I[I.length-1],x.addLayer(I.pop()),I.length<=0)return f(e,y.getItemIndex(),void 0,u);y=I[I.length-1]}for(;y&&y.getItemIndex()<n.itemsCount&&y.getItemOffset()+y.getItemHeight()<e+p;)if(y=m(y),I[0].getItemOffset()+I[0].getItemHeight()<e&&x.addLayer(I.shift()),(new Date).getTime()-o>a)return!0;for(var E=I[0],H=0;H<I.length;++H)if(I[H].getItemOffset()+I[H].getItemHeight()>=e+p){E=I[H];break}for(;y&&y.getItemIndex()>E.getItemIndex()+u;)x.addLayer(I.pop()),y=I[I.length-1];for(;y&&y.getItemIndex()<n.itemsCount-1&&y.getItemIndex()<E.getItemIndex()+u;)if(y=m(y),(new Date).getTime()-o>a)return!0;var O=I[0]&&I[0].getItemOffset();return I.forEach(function(e){e.getItemOffset()!=O&&e.setItemOffset(O),O+=e.getItemHeight()}),!1}function l(e){var t=s(e.getItemIndex()-1);return t&&(t.setItemOffset(e.getItemOffset()-t.getItemHeight()),I.unshift(t)),t}function m(e){var t=s(e.getItemIndex()+1);return t&&(t.setItemOffset(e.getItemOffset()+e.getItemHeight()),I.push(t)),t}function s(e){if(e==n.itemsCount)return n.hasMore?g():null;var t=n.itemTypeGetter?n.itemTypeGetter(e):"",r=u(e,t);return n.itemRenderer(e,r.getDomElement()),r}function u(e,i){var o=i||(n.itemTypeGetter?n.itemTypeGetter(e):""),a=x.borrowLayerWithIdentifier(o);null==a&&(a=new r(t));var f=!n.recalculateItemHeights&&n.itemHeightGetter&&n.itemHeightGetter(e);return a.attach(e,n.useNativeScroller?0:13,f,o),a}function g(){if(0==I.length||"$LoadMore"!=I[I.length-1].getIdentifier()){var e=u(n.itemsCount,"$LoadMore");return n.loadMoreRenderer(n.itemsCount,e.getDomElement()),v||(v=!0,o(function(){v=!1})),e}return I[I.length-1]}function c(){p=e.clientHeight,d=e.clientWidth,I.forEach(function(e){n.itemRenderer(e.getItemIndex(),e.getDomElement()),e.setItemHeight(0)})}function h(){return I}var p=e.clientHeight,d=e.clientWidth,I=[],v=!1,x=new i;return{render:f,refresh:c,getRenderedItems:h}};e.exports=f},function(e,t,n){var r=n(4),i=function(e){function t(e,t,n,i){return h=e,r.applyElementStyle(u,{right:t+"px",width:"100%",height:n+"px",overflow:"hidden"}),p=n,g=i,this}function n(){return h}function i(){return u}function o(){return g}function a(){return c}function f(e){r.applyTransformStyle(u,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+e+", 0, 1)"),c=e}function l(){return p||(p=i().clientHeight)}function m(e){p=e}function s(){var e=document.createElement("div");return r.applyElementStyle(e,{position:"absolute",top:0,left:0}),e}var u=null,g="",c=-1,h=-1,p=0;return u=s(),e.appendChild(u),{attach:t,getItemIndex:n,getDomElement:i,getItemOffset:a,setItemOffset:f,getItemHeight:l,setItemHeight:m,getIdentifier:o}};e.exports=i},function(e,t,n){var r=n(4),i=function(){function e(e,t){var i=e.getIdentifier();null==n[i]&&(n[i]=[]),n[i].push(e),e.setItemOffset(-1e4),r.applyElementStyle(e.getDomElement(),{display:"none"}),t&&r.applyElementStyle(e.getDomElement(),{display:"none"})}function t(e){if(null==n[e])return null;var t=n[e].pop();return null!=t&&r.applyElementStyle(t.getDomElement(),{display:"block"}),t}var n={};return{addLayer:e,borrowLayerWithIdentifier:t}};e.exports=i}])});